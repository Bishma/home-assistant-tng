- id: 'notification_temperatures-equal'
  alias: Temperatures Equal
  trigger:
  - platform: template
    value_template: >
      {% if states('sensor.cottage_temperature') | round == states('sensor.netatmo_outdoor_temperature') | round %}
        true
      {% endif %}
  condition: 
    - condition: template
      value_template: '{{ as_timestamp(now()) | int - as_timestamp(states.automation.temperatures_equal.attributes.last_triggered) | int > 21600 }}'
  action:
  - data_template:
      message: >
        Hi There,

        Indoor and outdoor temperatures have equalized at {{ states("sensor.netatmo_outdoor_temperature") }} degrees. Inside the humidity is {{ states("sensor.netatmo_indoor_humidity") }}%. Outdoor humidity is {{ states("sensor.netatmo_outdoor_humidity") }}%.
    service: notify.general
- id: notification_nws-weather-alert
  alias: NWS Notification Weather Alert
  trigger:
    platform: state
    entity_id: sensor.nws_alert_count
  condition:
    - condition: template
      value_template: '{{states.sensor.nws_alert_count.state | int > 0}}'
    - condition: template
      value_template: '{{ as_timestamp(now()) | int - as_timestamp(states.automation.nws_notification_weather_alert.attributes.last_triggered) | int > 21600 }}'
  action:
  - data_template:
      message: >
        Hi There,

        I've detected a change in national weather service advisories for Eugene.
        {% for i in range(states('sensor.nws_alert_count') | int) %}
          {%- if i > 0 -%}
            ---------
          {%- endif %}
          {{ state_attr('sensor.nws_alert_event', 'features')[i].properties.headline }}
          {{ state_attr('sensor.nws_alert_event', 'features')[i].properties.description }}
        {% endfor %}
    service: notify.general
- id: notification_hass-update
  alias: Home Assistant Update Notification
  trigger:
    platform: state
    entity_id: sensor.update_available
    from: 'off'
    to: 'on'
  action:
  - data_template:
      message: >
        Hi There,

        I am out of date. I am currently version {{ states("sensor.current_version") }} and {{ states("updater.updater") }} is now available. You should be able to find more information by visiting https://www.home-assistant.io/blog/
    service: notify.general